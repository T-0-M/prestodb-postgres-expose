version: '3.5'

services:
  prestogres:
    ports:
      - 6689:8889
      - 5679:5679
    build:
      context: ./
      dockerfile: prestogres.Dockerfile

    volumes:
      - ./prestogres.conf:/usr/local/etc/prestogres.conf
      - ./prestogres_hba.conf:/usr/local/etc/prestogres_hba.conf
      - /Users/tom/.ssh/tomhewitt.pem:/root/.ssh/tomhewitt.pem
      - /Users/tom/.ssh/id_rsa:/root/.ssh/id_rsa

    cap_add:
      - NET_ADMIN

    networks:
      backend:

  # pgpool:
  #     image: bitnami/pgpool:4
  #     ports:
  #       - 5432:5432
  #     environment:
  #       - PGPOOL_BACKEND_NODES=0:prestogres:5439
  #       - PGPOOL_SR_CHECK_USER=customuser
  #       - PGPOOL_SR_CHECK_PASSWORD=custompassword
  #       - PGPOOL_ENABLE_LDAP=no
  #       - PGPOOL_POSTGRES_USERNAME=postgres
  #       - PGPOOL_POSTGRES_PASSWORD=adminpassword
  #       - PGPOOL_ADMIN_USERNAME=admin
  #       - PGPOOL_ADMIN_PASSWORD=adminpassword
  #     healthcheck:
  #       test: ["CMD", "/healthcheck.sh"]
  #       interval: 10s
  #       timeout: 5s
  #       retries: 5
  #     networks:
  #       backend:

volumes:
  db-data:

networks:
  backend:
    name: connexions
